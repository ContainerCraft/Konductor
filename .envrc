#!/usr/bin/env bash

# Source environment variables from .env and temporary environment
source_env .env 2>/dev/null || true
source .tmpenv 2>/dev/null || true

# Add local bin directories to PATH
PATH_add .venv/bin
PATH_add .github/bin

# Platform Architecture Detection
export ARCH=$(uname -m | awk '{ if ($1 == "x86_64") print "amd64"; else if ($1 == "aarch64" || $1 == "arm64") print "arm64"; else print "unknown" }')

# Basic Configuration
export BROWSER=echo
export KUBECONFIG=$PWD/.kube/config
export TALOSCONFIG=$PWD/.talos/manifest/talosconfig

# Pulumi Configuration
# See: https://www.pulumi.com/docs/cli/environment-variables
export PULUMI_SKIP_UPDATE_CHECK=true
export PULUMI_SKIP_CONFIRMATIONS=true
export PULUMI_AUTOMATION_API_SKIP_VERSION_CHECK=true

# Optional Configuration (commented out by default)
#export OMNICONFIG=.talos/omniconfig

# Optional Pulumi Backend Configuration
# Uncomment for local backend instead of Pulumi Cloud
#export PULUMI_BACKEND_URL=${PULUMI_BACKEND_URL:-file://$PWD/.pulumi}
#export PULUMI_CONFIG_PASSPHRASE=${PULUMI_CONFIG_PASSPHRASE:-foobarbaz}
#export PULUMI_HOME=$PWD/.pulumi
#export PULUMI_K8S_DELETE_UNREACHABLE=true
